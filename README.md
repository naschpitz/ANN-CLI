# ANN-CLI

A command-line interface for training, testing, and running Artificial Neural Networks.

## Building

```bash
mkdir build && cd build
cmake ..
make
```

## Usage

```bash
# Training
ANN-CLI --mode train --config <config_file> [options]

# Running inference
ANN-CLI --mode run --model <model_file> --input <input_file> [options]

# Testing/evaluation
ANN-CLI --mode test --model <model_file> --samples <samples_file> [options]
```

### Options

| Option | Short | Description |
|--------|-------|-------------|
| `--mode` | `-m` | Mode: `train`, `run`, or `test` (required) |
| `--config` | `-c` | Path to JSON configuration file (train mode) |
| `--model` | | Path to trained model file (run/test modes) |
| `--device` | `-d` | Device: `cpu` or `gpu` (default: `cpu`) |
| `--samples` | `-s` | Path to JSON file with samples (for train/test modes) |
| `--idx-data` | | Path to IDX3 data file (alternative to `--samples`) |
| `--idx-labels` | | Path to IDX1 labels file (requires `--idx-data`) |
| `--input` | `-i` | Path to JSON file with input values (run mode) |
| `--output` | `-o` | Output file for saving trained model (train mode) |
| `--help` | `-h` | Show help message |

### Modes

- **train**: Train a neural network using `--config` and samples, outputs a trained model file.
- **run**: Run inference using `--model` with a single input.
- **test**: Evaluate a trained `--model` on test samples and report the loss (MSE).

## JSON File Formats

### Configuration File

The configuration file defines the neural network architecture and training parameters.

```json
{
  "layersConfig": [
    { "numNeurons": 784, "actvFunc": "relu" },
    { "numNeurons": 128, "actvFunc": "relu" },
    { "numNeurons": 64, "actvFunc": "relu" },
    { "numNeurons": 10, "actvFunc": "sigmoid" }
  ],
  "trainingConfig": {
    "numEpochs": 100,
    "learningRate": 0.01,
    "numThreads": 0
  }
}
```

#### Layers Configuration

- `numNeurons`: Number of neurons in the layer
- `actvFunc`: Activation function. Available options:
  - `relu` - Rectified Linear Unit
  - `sigmoid` - Sigmoid function
  - `tanh` - Hyperbolic tangent

#### Training Configuration (optional)

- `numEpochs`: Number of training epochs
- `learningRate`: Learning rate for gradient descent
- `numThreads`: Number of CPU threads to use for training (default: 0 = use all available cores). Set to 1 for single-threaded execution.

### Model File (output from training)

The trained model file contains the network architecture and learned weights:

```json
{
  "layersConfig": [...],
  "parameters": {
    "weights": [...],
    "biases": [...]
  }
}
```

This file is generated by `--mode train` and used by `--mode run` and `--mode test` via the `--model` option.

### Samples File (JSON format)

Training samples with input/output pairs:

```json
{
  "samples": [
    {
      "input": [0.0, 0.5, 1.0, 0.75],
      "output": [1.0, 0.0]
    },
    {
      "input": [1.0, 0.25, 0.0, 0.5],
      "output": [0.0, 1.0]
    }
  ]
}
```

### Input File (for run mode)

```json
{
  "input": [0.0, 0.5, 1.0, 0.75]
}
```

## IDX File Format

As an alternative to JSON samples, you can use IDX format files (commonly used for MNIST and similar datasets):

- **IDX3**: Multi-dimensional data (e.g., images)
- **IDX1**: Labels

The data is automatically normalized to 0-1 range and labels are one-hot encoded.

## Examples

### Training with JSON samples

```bash
ANN-CLI --config model.json --mode train --samples training_data.json --output trained_model.json
```

### Training with IDX files

```bash
ANN-CLI --config model.json --mode train --idx-data train-images-idx3-ubyte --idx-labels train-labels-idx1-ubyte --output trained_model.json
```

### Training on GPU

```bash
ANN-CLI --mode train --config model.json --device gpu --samples training_data.json
```

### Running inference

```bash
ANN-CLI --mode run --model trained_model.json --input test_input.json
```

### Running inference on GPU

```bash
ANN-CLI --mode run --model trained_model.json --device gpu --input test_input.json
```

### Testing a model with JSON samples

```bash
ANN-CLI --mode test --model trained_model.json --samples test_data.json
```

### Testing a model with IDX files

```bash
ANN-CLI --mode test --model trained_model.json --idx-data t10k-images-idx3-ubyte --idx-labels t10k-labels-idx1-ubyte
```

### Testing on GPU

```bash
ANN-CLI --mode test --model trained_model.json --device gpu --samples test_data.json
```

## License

See [LICENSE.md](LICENSE.md) for details.

